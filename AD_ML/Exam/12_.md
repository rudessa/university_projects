# БИЛЕТ №12
## 12. Корреляция - линейная и ранговая. Значимость корреляции и размер эффекта. Интерпретация корреляции
## 12.1. [Коэффициент корреляции. Диаграмма рассеяния. Коэффициент корреляцииПирсона. Факторы, влияющие на коэффициент корреляции. Требование к выборке для тестирования гипотезы о коэффициенте корреляции Пирсона.](#32-коэффициент-корреляции-диаграмма-рассеяния-коэффициент-корреляции-пирсона-факторы-влияющие-на-коэффициент-корреляции-требование-к-выборке-для-тестирования-гипотезы-о-коэффициенте-корреляции-пирсона)





# БИЛЕТ №12
## 12. Корреляция - линейная и ранговая. Значимость корреляции и размер эффекта. Интерпретация корреляции
# ---

**Теория:**

- **Типы корреляции**:
  - Линейная (Пирсона).
  - Ранговая (Спирмена).

- **Значимость корреляции**:
  - Проверяется с помощью P-value.

- **Размер эффекта**:
  - Интерпретируется через коэффициент корреляции \( r \).

**Код:**

```python
from scipy.stats import pearsonr, spearmanr

# Генерация данных
np.random.seed(42)
x = np.random.rand(100)
y = 2 * x + np.random.normal(0, 0.1, 100)

# Линейная корреляция
r, p = pearsonr(x, y)
print(f"Коэффициент корреляции Пирсона: {r}, P-значение: {p}")

# Ранговая корреляция
r_rank, p_rank = spearmanr(x, y)
print(f"Коэффициент корреляции Спирмена: {r_rank}, P-значение: {p_rank}")
```

# ---


## 12.1. Коэффициент корреляции. Диаграмма рассеяния. Коэффициент корреляции Пирсона. Факторы, влияющие на коэффициент корреляции. Требование к выборке для тестирования гипотезы о коэффициенте корреляции Пирсона.

### F-критерий

F-критерий используется для сравнения дисперсий двух или более выборок. Основное применение F-критерия - это дисперсионный анализ (ANOVA), который позволяет оценить, существуют ли значимые различия между средними значениями нескольких групп.

F-статистика рассчитывается как отношение между межгрупповой дисперсией ($MS_{between}$) и внутригрупповой дисперсией ($MS_{within}$):

$$F = \frac{MS_{between}}{MS_{within}}$$

где

$$MS_{between} = \frac{SS_{between}}{df_{between}}$$

$$MS_{within} = \frac{SS_{within}}{df_{within}}$$

и

$$SS_{between}$$ 

сумма квадратов между группами,

$$SS_{within}$$ 

сумма квадратов внутри групп,

$$df_{between}$$ 

степени свободы между группами,

$$df_{within}$$ 

степени свободы внутри групп.

### Связь с двухвыборочным t-критерием Стьюдента

Двухвыборочный t-критерий Стьюдента используется для сравнения средних значений двух независимых выборок. Существует связь между t-критерием и F-критерием: если у нас есть две группы, то квадрат t-статистики эквивалентен F-статистике.

Если $t$ - t-статистика для сравнения двух групп, то

$$F = t^2$$

Это означает, что если у нас есть только две группы, ANOVA и t-тест дадут идентичные результаты.

#### Требования к выборкам для проведения дисперсионного анализа (ANOVA)

Для корректного применения дисперсионного анализа необходимо соблюдать следующие условия:

1. **Независимость наблюдений**: Каждый участник или объект должен быть измерен независимо от других.
2. **Нормальность распределения**: Данные в каждой группе должны быть приблизительно нормально распределены. Это особенно важно для малых выборок.
3. **Гомогенность дисперсий**: Дисперсии в разных группах должны быть приблизительно равны. Это можно проверить с помощью теста Левена или Бартлетта.
4. **Равное число наблюдений** (желательно, но не обязательно): ANOVA более устойчива, если в каждой группе одинаковое количество наблюдений.

Если данные не соответствуют этим условиям, могут быть использованы непараметрические методы, такие как критерий Краскела-Уоллиса.

#### Пример

Предположим, у нас есть три группы студентов, каждая из которых прошла тест на время реакции. Мы хотим определить, различаются ли средние времена реакции между этими группами.

1. **Данные:**

   Группа 1: $[20, 22, 19, 24, 20]$  
   Группа 2: $[28, 30, 27, 31, 29]$  
   Группа 3: $[22, 24, 19, 23, 21]$

2. **Вычисление средних значений:**

   $$\bar{X}_1 = 21, \bar{X}_2 = 29, \bar{X}_3 = 21.8, \bar{X} = 23.27$$

3. **Вычисление дисперсий:**

   - **Межгрупповая дисперсия:**

     $$SS_{between} = 5(21 - 23.27)^2 + 5(29 - 23.27)^2 + 5(21.8 - 23.27)^2 = 153.35$$

   - **Внутригрупповая дисперсия:**

     $$SS_{within} = (20-21)^2 + (22-21)^2 + (19-21)^2 + (24-21)^2 + (20-21)^2 + \ldots + (23-21.8)^2 + (21-21.8)^2 = 32$$

4. **Вычисление F-статистики:**

   $$MS_{between} = \frac{SS_{between}}{df_{between}} = \frac{153.35}{2} = 76.675$$

   $$MS_{within} = \frac{SS_{within}}{df_{within}} = \frac{32}{12} = 2.667$$

   $$F = \frac{MS_{between}}{MS_{within}} = \frac{76.675}{2.667} = 28.75$$

5. **Сравнение с критическим значением F** для заданного уровня значимости и степеней свободы (можно использовать F-таблицы или программное обеспечение).

#### Результаты:

Если $F$-статистика больше критического значения, нулевая гипотеза отвергается, что означает, что есть статистически значимые различия между средними значениями групп.

[Вернуться к вопросам](#ответы-на-вопросы-по-теории)
